
DELIMITER //
CREATE PROCEDURE SELECT_DELIVERY_RETURN(IN DELIVERY_RETURN_NUM_PARAM VARCHAR(20))
BEGIN
DECLARE EXIT HANDLER FOR SQLEXCEPTION
BEGIN
ROLLBACK;
RESIGNAL;
END;
START TRANSACTION;
SELECT DEBTOR_NUM, DEBTOR_NAME, DEBTOR_ADDRESS, DELIVERY_RETURN_NUM,DELIVERY_RETURN_DATE,DELIVERY_RETURN_DESC, DELIVERY_RETURN_NUM AS DELIVERY_RETURN_NUM_OLD FROM debtor JOIN delivery_return USING (DEBTOR_NUM) WHERE DELIVERY_RETURN_NUM=DELIVERY_RETURN_NUM_PARAM;
SELECT DELIVERY_RETURNLINE_LINENUMBER,DELIVERY_RETURNLINE_STOCK_NUM,DELIVERY_RETURNLINE_STOCK_DESC,DELIVERY_RETURNLINE_STOCK_QTY FROM delivery_returnline WHERE DELIVERY_RETURN_NUM=DELIVERY_RETURN_NUM_PARAM;
SELECT DELIVERY_RETURNLINE_LINENUMBER,STOCK_NUM,DELIVERY_RETURN_STOCK_QTY FROM delivery_return_stock WHERE DELIVERY_RETURN_NUM=DELIVERY_RETURN_NUM_PARAM;
COMMIT;
END//