
DELIMITER //
CREATE PROCEDURE SELECT_PURCHASE_DEBIT_NOTE(IN PURCHASE_DEBIT_NOTE_NUM_PARAM VARCHAR(50))
BEGIN
DECLARE EXIT HANDLER FOR SQLEXCEPTION
BEGIN
ROLLBACK;
RESIGNAL;
END;
START TRANSACTION;
SELECT CREDITOR_NUM, CREDITOR_NAME, CREDITOR_ADDRESS,PURCHASE_DEBIT_NOTE_NUM,PURCHASE_DEBIT_NOTE_DATE,PURCHASE_DEBIT_NOTE_DESC,PURCHASE_DEBIT_NOTE_CREDIT_TERM, purchase_debit_note.GL_ACC_NUM, PURCHASE_DEBIT_NOTE_NUM AS PURCHASE_DEBIT_NOTE_NUM_OLD FROM creditor JOIN purchase_debit_note USING (CREDITOR_NUM) WHERE PURCHASE_DEBIT_NOTE_NUM=PURCHASE_DEBIT_NOTE_NUM_PARAM;
SELECT PURCHASE_DEBIT_NOTELINE_LINENUMBER,PURCHASE_DEBIT_NOTELINE_STOCK_NUM,PURCHASE_DEBIT_NOTELINE_STOCK_DESC,PURCHASE_DEBIT_NOTELINE_STOCK_PRICE,PURCHASE_DEBIT_NOTELINE_STOCK_QTY,PURCHASE_DEBIT_NOTELINE_DISCOUNT FROM purchase_debit_noteline WHERE PURCHASE_DEBIT_NOTE_NUM=PURCHASE_DEBIT_NOTE_NUM_PARAM;
COMMIT;
END//