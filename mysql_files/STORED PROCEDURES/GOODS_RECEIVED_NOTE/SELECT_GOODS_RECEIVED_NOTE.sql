
DELIMITER //
CREATE PROCEDURE SELECT_GOODS_RECEIVED_NOTE(IN GOODS_RECEIVED_NOTE_NUM_PARAM VARCHAR(20))
BEGIN
DECLARE EXIT HANDLER FOR SQLEXCEPTION
BEGIN
ROLLBACK;
RESIGNAL;
END;
START TRANSACTION;
SELECT CREDITOR_NUM, CREDITOR_NAME, CREDITOR_ADDRESS, GOODS_RECEIVED_NOTE_NUM,GOODS_RECEIVED_NOTE_DATE,GOODS_RECEIVED_NOTE_DESC, GOODS_RECEIVED_NOTE_NUM AS GOODS_RECEIVED_NOTE_NUM_OLD FROM creditor JOIN goods_received_note USING (CREDITOR_NUM) WHERE GOODS_RECEIVED_NOTE_NUM=GOODS_RECEIVED_NOTE_NUM_PARAM;
SELECT GOODS_RECEIVED_NOTELINE_LINENUMBER,GOODS_RECEIVED_NOTELINE_STOCK_NUM,GOODS_RECEIVED_NOTELINE_STOCK_DESC,GOODS_RECEIVED_NOTELINE_STOCK_QTY FROM goods_received_noteline WHERE GOODS_RECEIVED_NOTE_NUM=GOODS_RECEIVED_NOTE_NUM_PARAM;
COMMIT;
END//